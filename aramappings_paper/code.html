<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="generator" content="litedown 0.8">
<title></title>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  print-color-adjust: exact;
  -webkit-print-color-adjust: exact;
}
body, .abstract, code, .footnotes, footer, #refs, .caption { font-size: .9em; }
li li { font-size: .95em; }
ul:has(li > input[type="checkbox"]) { list-style: none; padding-left: 1em; }
*, :before, :after { box-sizing: border-box; }
a { color: steelblue; }
pre, img { max-width: 100%; }
pre { white-space: pre-wrap; word-break: break-word; }
pre code { display: block; padding: 1em; overflow-x: auto; }
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre, th) > code, code[class], div > .caption { background: #f8f8f8; }
pre > code:is(:not([class]), .language-plain, .language-none, .plain), .box, .figure, .table { background: inherit; border: 1px solid #eee; }
pre > code {
  &.message { border-color: #9eeaf9; }
  &.warning { background: #fff3cd; border-color: #fff3cd; }
  &.error { background: #f8d7da; border-color: #f8d7da; }
}
.fenced-chunk { border-left: 1px solid #666; }
.code-fence {
  opacity: .4;
  border: 1px dashed #666;
  border-left: 2px solid;
  &:hover { opacity: inherit; }
}
.box, .figure, .table, table { margin: 1em auto; }
div > .caption { padding: 1px 1em; }
.figure { p:has(img, svg), pre:has(svg) { text-align: center; } }
.flex-col { display: flex; justify-content: space-between; }
table {
  &:only-child:not(.table > *) { margin: auto; }
  th, td { padding: 5px; font-variant-numeric: tabular-nums; }
  thead, tfoot, tr:nth-child(even) { background: whitesmoke; }
  thead th { border-bottom: 1px solid #ddd; }
  &:not(.datatable-table) {
    border-top: 1px solid #666;
    border-bottom: 1px solid #666;
  }
}
blockquote {
  color: #666;
  margin: 0;
  padding: 1px 1em;
  border-left: .5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC {
  a { text-decoration: none; }
  ul { list-style: none; padding-left: 1em; }
  & > ul { padding: 0; }
  ul ul { border-left: 1px solid lightsteelblue; }
}
.body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.main-number::after { content: "."; }
span[class^="ref-number-"] { font-weight: bold; }
.ref-number-fig::after, .ref-number-tab::after { content: ":"; }
.cross-ref-chp::before { content: "Chapter "; }
.cross-ref-sec::before { content: "Section "; }
.cross-ref-fig::before, .ref-number-fig::before { content: "Figure "; }
.cross-ref-tab::before, .ref-number-tab::before { content: "Table "; }
.cross-ref-eqn::before, .MathJax_ref:has(mjx-mtext > mjx-c + mjx-c)::before { content: "Equation "; }
.abstract, #refs {
  &::before { display: block; margin: 1em auto; font-weight: bold; }
}
.abstract::before { content: "Abstract"; text-align: center; }
#refs::before { content: "Bibliography"; font-size: 1.5em; }
.ref-paren-open::before { content: "("; }
.ref-paren-close::after { content: ")"; }
.ref-semicolon::after { content: "; "; }
.ref-and::after { content: " and "; }
.ref-et-al::after { content: " et al."; font-style: italic; }
.footnote-ref a {
  &::before { content: "["; }
  &::after { content: "]"; }
}
section.footnotes {
  margin-top: 2em;
  &::before { content: ""; display: block; max-width: 20em; }
}
.fade {
  background: repeating-linear-gradient(135deg, white, white 30px, #ddd 32px, #ddd 32px);
  opacity: 0.6;
}

@media print {
  body { max-width: 100%; }
  tr, img { break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  body:not(.pagesjs) pre:has(.line-numbers):not(:hover) { white-space: pre; }
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@1.14.14/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</head>
<body>
<div class="frontmatter">
</div>
<div class="body">
<pre><code class="language-r">############################### Clear environment ##############################

message(&quot;***********************************************************************************************\n&quot;)
</code></pre>
<pre><code>## ***********************************************************************************************
</code></pre>
<pre><code class="language-r">message(&quot;Replication script for 'aramappings: An R Package for Computing Adaptable Radial Axes Mappings'\n&quot;)
</code></pre>
<pre><code>## Replication script for 'aramappings: An R Package for Computing Adaptable Radial Axes Mappings'
</code></pre>
<pre><code class="language-r">message(&quot;***********************************************************************************************\n\n&quot;)
</code></pre>
<pre><code>## ***********************************************************************************************
</code></pre>
<pre><code class="language-r">############################### Set working directory ##########################

if (Sys.getenv(&quot;RSTUDIO&quot;) == &quot;1&quot;) {

  rm(list = ls())

  setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
} else {
  setwd(getSrcDirectory(function() {})[1])
}
</code></pre>
<pre><code>## Error in setwd(dirname(rstudioapi::getActiveDocumentContext()$path)): no es posible cambiar el directorio de trabajo
</code></pre>
<pre><code class="language-r">message(&quot;Generating paper's radial axes plots in folder: &quot;, getwd(), &quot;\n&quot;)
</code></pre>
<pre><code>## Generating paper's radial axes plots in folder: O:/GIT_working_directory_NPC/JSS/Version01/article/replication_script
</code></pre>
<pre><code class="language-r">############################### Load packages ##################################

if (!require(aramappings)) {
  message(&quot;Trying to install aramappings&quot;)
  install.packages(&quot;aramappings&quot;)
  if(!require(aramappings)){
    stop(&quot;could not install aramappings&quot;)
  }
}

if (!require(ggplot2)) {
  message(&quot;Trying to install package ggplot2&quot;)
  install.packages(&quot;ggplot2&quot;)
  if(!require(ggplot2)){
    stop(&quot;Could not install package ggplot2&quot;)
  }
}

if (!require(pracma)) {
  message(&quot;Trying to install package pracma&quot;)
  install.packages(&quot;pracma&quot;)
  if(!require(pracma)){
    stop(&quot;Could not install package pracma&quot;)
  }
}

if (!require(geometry)) {
  message(&quot;Trying to install package geometry&quot;)
  install.packages(&quot;geometry&quot;)
  if(!require(geometry)){
    stop(&quot;Could not install package geometry&quot;)
  }
}

if (!require(stats)) {
  message(&quot;Trying to install package stats&quot;)
  install.packages(&quot;stats&quot;)
  if(!require(stats)){
    stop(&quot;Could not install package stats&quot;)
  }
}

if (!require(grid)) {
  message(&quot;Trying to install package grid&quot;)
  install.packages(&quot;grid&quot;)
  if(!require(grid)){
    stop(&quot;Could not install package grid&quot;)
  }
}

if (!require(RSpectra)) {
  message(&quot;Trying to install package RSpectra&quot;)
  install.packages(&quot;RSpectra&quot;)
  if(!require(RSpectra)){
    stop(&quot;Could not install package RSpectra&quot;)
  }
}

if (!require(grDevices)) {
  message(&quot;Trying to install package grDevices&quot;)
  install.packages(&quot;grDevices&quot;)
  if(!require(grDevices)){
    stop(&quot;Could not install package grDevices&quot;)
  }
}

if (!require(viridis)) {
  message(&quot;Trying to install package viridis&quot;)
  install.packages(&quot;viridis&quot;)
  if(!require(viridis)){
    stop(&quot;Could not install package viridis&quot;)
  }
}

if (!require(liver)) {
  message(&quot;Trying to install package liver&quot;)
  install.packages(&quot;liver&quot;)
  if(!require(liver)){
    stop(&quot;Could not install package liver&quot;)
  }
}

if (!require(ascentTraining)) {
  message(&quot;Trying to install package ascentTraining&quot;)
  install.packages(&quot;ascentTraining&quot;)
  if(!require(ascentTraining)){
    stop(&quot;Could not install package ascentTraining&quot;)
  }
}


############################### Auxiliary functions ############################

radviz &lt;- function(X, V, normalize = TRUE) {
  EPSILON &lt;- 10^(-12)

  N &lt;- nrow(X)
  n &lt;- ncol(X)

  if (normalize) {
    # min-max normalization
    minimum &lt;- apply(X, 2, min)
    maximum &lt;- apply(X, 2, max)
    X &lt;- (X - pracma::repmat(minimum, N, 1)) / (pracma::repmat(maximum, N, 1) - pracma::repmat(minimum, N, 1))

    # normalize so each row sums 1
    sum_row &lt;- rowSums(X)
    for (i in 1:N)
    {
      s &lt;- sum_row[i]
      if (s &lt; EPSILON * n) {
        X[i, ] &lt;- ones(1, n) / n
      } else {
        X[i, ] &lt;- X[i, ] / s
      }
    }
  }

  return(X %*% V)
}

principal_component_biplot &lt;- function(X, m = 2, c = 0, k = 1) {
  svd_res &lt;- RSpectra::svds(X, m) # Compute singular value decomposition

  P &lt;- k * svd_res$u %*% diag(svd_res$d^(1 - c)) # Optimal projected points
  V &lt;- svd_res$v %*% diag(svd_res$d^c) / k # Optimal axis vectors

  return(list(&quot;P&quot; = P, &quot;V&quot; = V))
}


draw_radial_axes_plot_2d_standardized &lt;- function(
    Z,
    X,
    V,
    P,
    weights = rep(1, ncol(Z)),
    axis_lines = NULL,
    color_variable = NULL,
    projections_point = NULL,
    show_colorbar = FALSE,
    var_names_scale_factor = rep(1, ncol(Z)),
    var_names_horizontal_factor = 0.15,
    aspect_ratio = 1.618) {
  n &lt;- nrow(V)

  # Declare local variables
  w &lt;- x &lt;- y &lt;- P1 &lt;- P2 &lt;- V1 &lt;- V2 &lt;- V3 &lt;- V4 &lt;- NULL


  colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)
  variable_names &lt;- colnames(X)
  if (!is.null(color_variable)) {
    color_variable_name &lt;- variable_names[color_variable]
  } else {
    color_variable_name &lt;- NULL
  }

  # Original data means and standard deviations
  meanX &lt;- colMeans(X)
  stdX &lt;- apply(X, 2, stats::sd)

  # Initialize plot
  my_plot &lt;- ggplot2::ggplot()

  # Draw optional reference horizontal &amp; vertical lines
  my_plot &lt;- my_plot +
    ggplot2::geom_vline(xintercept = 0, linetype = &quot;dashed&quot;, color = &quot;gray80&quot;, linewidth = 0.5) +
    ggplot2::geom_hline(yintercept = 0, linetype = &quot;dashed&quot;, color = &quot;gray80&quot;, linewidth = 0.5)

  # Draw optional reference circle
  center &lt;- c(0, 0)
  npoints &lt;- 100
  tt &lt;- seq(0, 2 * pi, length.out = npoints)
  xx &lt;- center[1] + cos(tt)
  yy &lt;- center[2] + sin(tt)
  dfC &lt;- data.frame(x = xx, y = yy)
  my_plot &lt;- my_plot + ggplot2::geom_path(data = dfC, ggplot2::aes(x, y), linetype = &quot;dotted&quot;, color = &quot;gray80&quot;, linewidth = 0.5)

  # Set equal axes and empty background
  my_plot &lt;- my_plot + ggplot2::coord_equal() + ggplot2::theme_void()


  # Draw perpendicular dashed segments to axis lines from the point with index &quot;projections_point&quot;
  if (!is.null(projections_point) &amp;&amp; !is.null(axis_lines)) {
    p &lt;- as.vector(P[projections_point, ])

    Y &lt;- matrix(0, 0, 4)

    i &lt;- 0
    for (sel_var in axis_lines) {
      i &lt;- i + 1

      v &lt;- V[sel_var, ]

      Y &lt;- rbind(Y, c(p, v %*% ((v %*% p) / norm(v, type = &quot;2&quot;)^2)))
    }

    dfY &lt;- as.data.frame(Y)
    my_plot &lt;- my_plot + ggplot2::geom_segment(
      data = dfY, mapping = ggplot2::aes(x = V1, y = V2, xend = V3, yend = V4),
      linetype = &quot;dashed&quot;, alpha = 0.7, color = &quot;darkorange&quot;, linewidth = 1
    )
  }


  # Draw mapped points on a Cartesian plane
  dfZ &lt;- as.data.frame(Z)
  dfX &lt;- as.data.frame(X)
  dfP &lt;- as.data.frame(P)

  if (is.null(color_variable_name)) {
    dfPZ &lt;- cbind(dfP, dfZ)

    my_plot &lt;- my_plot + ggplot2::geom_point(data = dfPZ, mapping = ggplot2::aes(x = P1, y = P2), color = &quot;#4488FF&quot;, size = 2, alpha = 1, show.legend = FALSE)
  } else {
    colorVar &lt;- dfX[, match(color_variable_name, variable_names)]
    dfPZ &lt;- cbind(dfP, dfZ, colorVar)

    my_plot &lt;- my_plot + ggplot2::geom_point(data = dfPZ, mapping = ggplot2::aes(x = P1, y = P2, color = colorVar), size = 2, alpha = 1, show.legend = show_colorbar)

    # Color points using a viridis palette
    my_plot &lt;- my_plot + ggplot2::scale_colour_viridis_c()

    if (show_colorbar) {
      my_plot &lt;- my_plot + ggplot2::theme(legend.key.height = grid::unit(2, &quot;cm&quot;)) + ggplot2::theme(
        legend.title = ggplot2::element_text(size = 16),
        legend.text = ggplot2::element_text(size = 16)
      )

      my_plot &lt;- my_plot + ggplot2::labs(colour = color_variable_name)
    }
  }


  # Add a rectangular frame
  my_plot &lt;- my_plot + ggplot2::theme(panel.border = ggplot2::element_rect(fill = &quot;transparent&quot;, color = &quot;gray70&quot;, linewidth = 2), legend.position = &quot;right&quot;)

  # Set margins
  my_plot &lt;- my_plot + ggplot2::theme(plot.margin = ggplot2::margin(0.5, 0.5, 0.5, 0.5, &quot;cm&quot;))



  #################### Add calibrated axes ####################

  if (!is.null(axis_lines)) {
    for (sel_var in axis_lines) {
      # Compute data estimates axis of selected variable (sel_var)
      estimates &lt;- P %*% V[sel_var, ]

      # Draw axis line
      lo &lt;- floor(min(estimates))
      up &lt;- pracma::ceil(max(estimates))

      v &lt;- matrix(unlist(V[sel_var, ]), nrow = 1)
      vs &lt;- v / norm(v, type = &quot;2&quot;)^2 # scaled axis vector
      E &lt;- cbind(lo * vs, up * vs) # endpoints
      dfE &lt;- as.data.frame(E)
      my_plot &lt;- my_plot + ggplot2::geom_segment(
        data = dfE, mapping = ggplot2::aes(x = V1, y = V2, xend = V3, yend = V4),
        alpha = 0.7, color = &quot;gray30&quot;, linewidth = 1
      )

      # Draw tick marks
      size_tick_mark &lt;- 0.1
      v_perp &lt;- v
      v_perp[1, 1] &lt;- -v[1, 2]
      v_perp[1, 2] &lt;- v[1, 1]
      v_perp &lt;- v_perp / norm(v_perp, type = &quot;2&quot;) * size_tick_mark / 2

      T &lt;- matrix(0, up - lo + 1, 6)
      i &lt;- 1
      for (k in lo:up) {
        T[i, ] &lt;- cbind(k * vs + v_perp, k * vs - v_perp, k * vs)
        i &lt;- i + 1
      }
      dfT &lt;- as.data.frame(T)
      my_plot &lt;- my_plot + ggplot2::geom_segment(
        data = dfT, mapping = ggplot2::aes(x = V1, y = V2, xend = V3, yend = V4),
        alpha = 0.7, color = &quot;gray30&quot;, linewidth = 1
      )

      # Draw numeric values at tick marks
      TL &lt;- cbind(rep(0, up - lo + 1, 1), T[, 5:6])
      colnames(TL) &lt;- c(&quot;ticklabel&quot;, &quot;x&quot;, &quot;y&quot;)
      dfTL &lt;- as.data.frame(TL)

      i &lt;- 1
      for (k in lo:up) {
        dfTL[i, 1] &lt;- sprintf(&quot;%.3f&quot;, stdX[sel_var] * k + meanX[sel_var])
        i &lt;- i + 1
      }

      if (v_perp[1] &lt; 0) {
        v_perp &lt;- -v_perp
      }
      factor &lt;- 3
      x_offset &lt;- v_perp[1] * factor + 0.25
      y_offset &lt;- v_perp[2] * factor
      my_plot &lt;- my_plot + ggplot2::geom_text(
        data = dfTL, mapping = ggplot2::aes(x = x, y = y), label = dfTL$ticklabel, color = &quot;gray30&quot;, fontface = &quot;bold&quot;,
        nudge_x = x_offset, nudge_y = y_offset, check_overlap = T
      )
    }
  }


  # Draw axis vectors
  colnames(V) &lt;- c(&quot;V1&quot;, &quot;V2&quot;)
  dfV &lt;- as.data.frame(V)

  max_weight &lt;- max(weights)
  vector_colors &lt;- rep(1, n)
  for (i in 1:n) {
    gray_value &lt;- 1 - weights[i] / max_weight
    vector_colors[i] &lt;- grDevices::rgb(gray_value, gray_value, gray_value)
  }

  dfV &lt;- cbind(dfV, vector_colors)

  my_plot &lt;- my_plot + ggplot2::geom_segment(
    data = dfV, mapping = ggplot2::aes(x = 0, y = 0, xend = V1, yend = V2),
    arrow = ggplot2::arrow(angle = 30, length = grid::unit(7, &quot;pt&quot;), type = &quot;closed&quot;, ends = &quot;last&quot;),
    lineend = &quot;round&quot;, linejoin = &quot;mitre&quot;, alpha = 1, color = vector_colors, linewidth = 1
  )


  # Draw variable names
  vertical_offset &lt;- 0.2

  V_names_pos &lt;- diag(var_names_scale_factor) %*% V
  for (i in 1:n) {
    varname_length &lt;- nchar(variable_names[i])

    if (V[i, 2] &lt;= 0) {
      if (V[i, 1] &lt;= 0) {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(-varname_length * var_names_horizontal_factor, -vertical_offset)
      } else {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(varname_length * var_names_horizontal_factor, -vertical_offset)
      }
    } else {
      if (V[i, 1] &lt;= 0) {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(-varname_length * var_names_horizontal_factor, vertical_offset + 0.1)
      } else {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(varname_length * var_names_horizontal_factor, vertical_offset + 0.1)
      }
    }
  }

  dfVN &lt;- data.frame(
    varnames = variable_names,
    x = V_names_pos[, 1],
    y = V_names_pos[, 2]
  )
  my_plot &lt;- my_plot + ggplot2::geom_text(
    data = dfVN, mapping = ggplot2::aes(x = x, y = y),
    label = dfVN$varnames, family = &quot;sans&quot;, fontface = &quot;bold&quot;,
    color = &quot;black&quot;, check_overlap = F, size = 8
  )


  # Set aspect ratio

  x_limits &lt;- layer_scales(my_plot)$x$get_limits()
  y_limits &lt;- layer_scales(my_plot)$y$get_limits()

  x_min &lt;- x_limits[1]
  x_max &lt;- x_limits[2]
  y_min &lt;- y_limits[1]
  y_max &lt;- y_limits[2]


  extend_x &lt;- (aspect_ratio * (y_max - y_min) - (x_max - x_min)) / 2

  if (extend_x &gt; 0) {
    my_plot &lt;- my_plot + xlim(c(x_min - extend_x, x_max + extend_x))
  } else {
    extend_y &lt;- ((x_max - x_min) / aspect_ratio - (y_max - y_min)) / 2

    my_plot &lt;- my_plot + ylim(c(y_min - extend_y, y_max + extend_y))
  }



  # Draw plot
  my_plot
}


draw_radviz &lt;- function(
    X,
    V,
    P,
    color_variable = NULL,
    show_colorbar = FALSE,
    aspect_ratio = 1.618) {
  colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)
  variable_names &lt;- colnames(X)
  if (!is.null(color_variable)) {
    color_variable_name &lt;- variable_names[color_variable]
  } else {
    color_variable_name &lt;- NULL
  }

  # Initialize plot
  my_plot &lt;- ggplot2::ggplot()

  # Draw optional reference circle
  center &lt;- c(0, 0)
  npoints &lt;- 100
  tt &lt;- seq(0, 2 * pi, length.out = npoints)
  xx &lt;- center[1] + cos(tt)
  yy &lt;- center[2] + sin(tt)
  dfC &lt;- data.frame(x = xx, y = yy)
  my_plot &lt;- my_plot + ggplot2::geom_path(data = dfC, ggplot2::aes(x, y), linetype = &quot;dotted&quot;, color = &quot;gray80&quot;, linewidth = 0.5)

  # Set equal axes and empty background
  my_plot &lt;- my_plot + ggplot2::coord_equal() + ggplot2::theme_void()


  # Draw anchor points
  dfV &lt;- as.data.frame(V)
  my_plot &lt;- my_plot + geom_point(data = dfV, mapping = aes(x = x, y = y), color = &quot;gray70&quot;, size = 6, alpha = 0.5, show.legend = FALSE)

  dfV &lt;- cbind(dfV, rbind(dfV[2:n, ], dfV[1, ]))
  colnames(dfV) &lt;- c(&quot;x1&quot;, &quot;y1&quot;, &quot;x2&quot;, &quot;y2&quot;)
  my_plot &lt;- my_plot + geom_segment(data = dfV, mapping = aes(x = x1, y = y1, xend = x2, yend = y2), alpha = 1, color = &quot;gray50&quot;, linetype = &quot;dashed&quot;, linewidth = 1)



  # Draw mapped points on a Cartesian plane
  dfX &lt;- as.data.frame(X)
  dfP &lt;- as.data.frame(P)

  if (is.null(color_variable_name)) {
    dfPZ &lt;- cbind(dfP, dfX)

    my_plot &lt;- my_plot + ggplot2::geom_point(data = dfPZ, mapping = ggplot2::aes(x = P1, y = P2), color = &quot;#4488FF&quot;, size = 2, alpha = 1, show.legend = FALSE)
  } else {
    colorVar &lt;- dfX[, match(color_variable_name, variable_names)]
    dfPZ &lt;- cbind(dfP, dfX, colorVar)

    my_plot &lt;- my_plot + ggplot2::geom_point(data = dfPZ, mapping = ggplot2::aes(x = P1, y = P2, color = colorVar), size = 2, alpha = 1, show.legend = show_colorbar)

    # Color points using a viridis palette
    my_plot &lt;- my_plot + ggplot2::scale_colour_viridis_c()

    if (show_colorbar) {
      my_plot &lt;- my_plot + ggplot2::theme(legend.key.height = grid::unit(2, &quot;cm&quot;)) + ggplot2::theme(
        legend.title = ggplot2::element_text(size = 16),
        legend.text = ggplot2::element_text(size = 16)
      )

      my_plot &lt;- my_plot + ggplot2::labs(colour = color_variable_name)
    }
  }


  # Add a rectangular frame
  my_plot &lt;- my_plot + ggplot2::theme(panel.border = ggplot2::element_rect(fill = &quot;transparent&quot;, color = &quot;gray70&quot;, linewidth = 2), legend.position = &quot;right&quot;)

  # Set margins
  my_plot &lt;- my_plot + ggplot2::theme(plot.margin = ggplot2::margin(1, 1, 3, 1, &quot;cm&quot;))



  # Draw variable names
  vertical_offset &lt;- 0.2
  var_names_horizontal_factor &lt;- 0.05
  V_names_pos &lt;- V
  for (i in 1:n) {
    varname_length &lt;- nchar(variable_names[i])

    if (V[i, 2] &lt;= 0) {
      if (V[i, 1] &lt;= 0) {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(-varname_length * var_names_horizontal_factor, -vertical_offset)
      } else {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(varname_length * var_names_horizontal_factor, -vertical_offset)
      }
    } else {
      if (V[i, 1] &lt;= 0) {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(-varname_length * var_names_horizontal_factor, vertical_offset + 0.1)
      } else {
        V_names_pos[i, ] &lt;- V_names_pos[i, ] + c(varname_length * var_names_horizontal_factor, vertical_offset + 0.1)
      }
    }
  }

  dfVN &lt;- data.frame(
    varnames = variable_names,
    x = V_names_pos[, 1],
    y = V_names_pos[, 2]
  )
  my_plot &lt;- my_plot + ggplot2::geom_text(
    data = dfVN, mapping = ggplot2::aes(x = x, y = y),
    label = dfVN$varnames, family = &quot;sans&quot;, fontface = &quot;bold&quot;,
    color = &quot;black&quot;, check_overlap = F, size = 8
  )



  # Set aspect ratio

  x_limits &lt;- layer_scales(my_plot)$x$get_limits()
  y_limits &lt;- layer_scales(my_plot)$y$get_limits()

  x_min &lt;- x_limits[1]
  x_max &lt;- x_limits[2]
  y_min &lt;- y_limits[1]
  y_max &lt;- y_limits[2]


  extend_x &lt;- (aspect_ratio * (y_max - y_min) - (x_max - x_min)) / 2

  if (extend_x &gt; 0) {
    my_plot &lt;- my_plot + xlim(c(x_min - extend_x, x_max + extend_x))
  } else {
    extend_y &lt;- ((x_max - x_min) / aspect_ratio - (y_max - y_min)) / 2

    my_plot &lt;- my_plot + ylim(c(y_min - extend_y, y_max + extend_y))
  }


  # Draw plot
  my_plot
}



################################################################################
############################### Figure 1 #######################################
################################################################################

message(&quot;\nFigure 1\n&quot;)
</code></pre>
<pre><code>## 
## Figure 1
</code></pre>
<pre><code class="language-r">########################  Load data  ###########################################

data(&quot;cereal&quot;, package = &quot;liver&quot;)


# Define subset of (numerical) variables
selected_variables &lt;- c(&quot;calories&quot;, &quot;protein&quot;, &quot;sugars&quot;, &quot;vitamins&quot;)
data_names &lt;- cereal$name

X &lt;- cereal[, selected_variables] # Select a subset of variables
rm(cereal)


# Remove rows with missing values from X
has_neg &lt;- apply(X, 1, function(row) any(row &lt; 0))
rows_to_delete &lt;- which(has_neg) * (-1)
if (length(rows_to_delete) &gt; 0) {
  X &lt;- X[rows_to_delete, ]
  data_names &lt;- data_names[rows_to_delete]
}


# Convert X to matrix
X &lt;- apply(as.matrix.noquote(X), 2, as.numeric)

# Standardize the data
Z &lt;- scale(X)


########################  Axis vectors for subfigures (a) and (d)  #############

r &lt;- c(1, 0.75, 1, 1.2)
theta &lt;- c(195, 60, 165, 300) * 2 * pi / 360

V_ad &lt;- geometry::pol2cart(theta, r)
rownames(V_ad) &lt;- selected_variables
colnames(V_ad) &lt;- c(&quot;V1&quot;, &quot;V2&quot;)


########################  Subfigure (a) - Star Coordinates  ####################

# Star Coordinates' linear mapping
P &lt;- Z %*% V_ad

# Genearate the SC plot
filename &lt;- &quot;Figure_1a_Cereal_Star_Coordinates.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V_ad,
  P,
  color_variable = 1, # calories
  var_names_scale_factor = c(2.5, 2.2, 2.8, 1.2),
  var_names_horizontal_factor = 0.1,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_1a_Cereal_Star_Coordinates.pdf
</code></pre>
<pre><code class="language-r">########################  Subfigure (b) - RadViz  ##############################

n &lt;- ncol(X)
variable_ordering &lt;- c(2, 3, 4, 1) # &quot;protein&quot;, &quot;sugars&quot;, &quot;vitamins&quot;, &quot;calories&quot;
X_radviz &lt;- X[, variable_ordering]


r &lt;- rep(1, n)
diff_angle &lt;- 2 * pi / n
theta &lt;- (1:n) * diff_angle - diff_angle / 2
V_radviz &lt;- geometry::pol2cart(theta, r)
rownames(V_radviz) &lt;- selected_variables[variable_ordering]

# RadViz (nonlinear) mapping
P_radviz &lt;- radviz(X_radviz, V_radviz, normalize = TRUE)


# Genearate the RadViz plot
filename &lt;- &quot;Figure_1b_Cereal_RadViz.pdf&quot;
pdf(file = filename)
print(draw_radviz(
  X_radviz,
  V_radviz,
  P_radviz,
  color_variable = 1, # calories
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_1b_Cereal_RadViz.pdf
</code></pre>
<pre><code class="language-r">########################  Subfigure (c) - Principal Component Biplot  ##########

PCB &lt;- principal_component_biplot(Z)
P &lt;- PCB$P
V &lt;- PCB$V
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)
colnames(V) &lt;- c(&quot;V1&quot;, &quot;V2&quot;)
rownames(V) &lt;- selected_variables


# Genearate the Principal Component Biplot
filename &lt;- &quot;Figure_1c_Cereal_Biplot.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1:n,
  color_variable = 1, # calories
  projections_point = 4, # All-Bran with Extra Fiber
  show_colorbar = FALSE,
  var_names_scale_factor = c(7, 5, 5, 6),
  var_names_horizontal_factor = 0.1,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_1c_Cereal_Biplot.pdf
</code></pre>
<pre><code class="language-r">########################  Subfigure (d) - ARA Unconstrained L2  ################

mapping &lt;- ara_unconstrained_l2(Z, V_ad)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_1d_Cereal_ARA_unconstrained_l2.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V_ad,
  P,
  axis_lines = 1:n,
  color_variable = 1, # calories
  projections_point = 4, # All-Bran with Extra Fiber
  show_colorbar = FALSE,
  var_names_scale_factor = c(2.2, 3.5, 2.2, 2.1),
  var_names_horizontal_factor = 0.1,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_1d_Cereal_ARA_unconstrained_l2.pdf
</code></pre>
<pre><code class="language-r">################################################################################
#######  Prepare data, axis vectors, and weights for Figures 3, 4, and 5  ######
################################################################################

data(&quot;auto_mpg&quot;, package = &quot;ascentTraining&quot;)


# Define subset of (numerical) variables
selected_variables &lt;- c(&quot;mpg&quot;, &quot;horsepower&quot;, &quot;weight&quot;, &quot;acceleration&quot;)
data_names &lt;- auto_mpg$car_name

X &lt;- auto_mpg[, selected_variables] # Select a subset of variables
rm(auto_mpg)


# Remove rows with missing values from X
N &lt;- nrow(X)
rows_to_delete &lt;- NULL
for (i in 1:N) {
  if (sum(is.na(X[i, ])) &gt; 0) {
    rows_to_delete &lt;- c(rows_to_delete, -i)
  }
}
if (!is.null(rows_to_delete)) {
  X &lt;- X[rows_to_delete, ]
  data_names &lt;- data_names[rows_to_delete]
}


# Convert X to matrix
X &lt;- apply(as.matrix.noquote(X), 2, as.numeric)

# Standardize the data
Z &lt;- scale(X)

# List of weights (list of ones if w is not used)
w &lt;- c(1, 2 / 3, 2 / 3, 2 / 3)

# Matrix of axis vectors
r &lt;- c(0.8, 1, 1.2, 1)
theta &lt;- c(225, 100, 315, 80) * 2 * pi / 360
V &lt;- geometry::pol2cart(theta, r)
rownames(V) &lt;- selected_variables
colnames(V) &lt;- c(&quot;V1&quot;, &quot;V2&quot;)



################################################################################
############################### Figure 3 #######################################
################################################################################

message(&quot;\nFigure 3\n&quot;)
</code></pre>
<pre><code>## 
## Figure 3
</code></pre>
<pre><code class="language-r">########################  Subfigure (a) - ARA Unconstrained l2  ################

mapping &lt;- ara_unconstrained_l2(Z, V)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_3a_Auto-mpg_ARA_unconstrained_l2.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_3a_Auto-mpg_ARA_unconstrained_l2.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 976.08289793835
</code></pre>
<pre><code class="language-r">########################  Subfigure (b) - ARA Unconstrained l2 with weights  ###

mapping &lt;- ara_unconstrained_l2(Z, V, weights = w)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_3b_Auto-mpg_ARA_unconstrained_l2_weights.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  weights = w,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_3b_Auto-mpg_ARA_unconstrained_l2_weights.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 999.076511507813
</code></pre>
<pre><code class="language-r">########################  Subfigure (c) - ARA Exact l2  ########################

mapping &lt;- ara_exact_l2(Z, V, variable = 1)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_3c_Auto-mpg_ARA_exact_l2.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_3c_Auto-mpg_ARA_exact_l2.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 1131.23672744631
</code></pre>
<pre><code class="language-r">########################  Subfigure (d) - ARA Ordered l2  ########################

mapping &lt;- ara_ordered_l2(Z, V, variable = 1)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_3d_Auto-mpg_ARA_ordered_l2.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_3d_Auto-mpg_ARA_ordered_l2.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 1045.98513347049
</code></pre>
<pre><code class="language-r">################################################################################
############################### Figure 4 #######################################
################################################################################

message(&quot;\nFigure 4\n&quot;)
</code></pre>
<pre><code>## 
## Figure 4
</code></pre>
<pre><code class="language-r">########################  Subfigure (a) - ARA Unconstrained l1  ################

mapping &lt;- ara_unconstrained_l1(Z, V)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_4a_Auto-mpg_ARA_unconstrained_l1.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_4a_Auto-mpg_ARA_unconstrained_l1.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 730.891216159581
</code></pre>
<pre><code class="language-r">########################  Subfigure (b) - ARA Unconstrained l1 with weights  ###

mapping &lt;- ara_unconstrained_l1(Z, V, weights = w)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_4b_Auto-mpg_ARA_unconstrained_L1_weights.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  weights = w,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_4b_Auto-mpg_ARA_unconstrained_L1_weights.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 738.191082299998
</code></pre>
<pre><code class="language-r">########################  Subfigure (c) - ARA Exact l1  ########################

mapping &lt;- ara_exact_l1(Z, V, variable = 1)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_4c_Auto-mpg_ARA_exact_L1.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_4c_Auto-mpg_ARA_exact_L1.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 755.976043492109
</code></pre>
<pre><code class="language-r">########################  Subfigure (d) - ARA Ordered l1  ########################

mapping &lt;- ara_ordered_l1(Z, V, variable = 1)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_4d_Auto-mpg_ARA_ordered_L1.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_4d_Auto-mpg_ARA_ordered_L1.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 755.010073537356
</code></pre>
<pre><code class="language-r">################################################################################
############################### Figure 5 #######################################
################################################################################

message(&quot;\nFigure 5\n&quot;)
</code></pre>
<pre><code>## 
## Figure 5
</code></pre>
<pre><code class="language-r">########################  Subfigure (a) - ARA Unconstrained l-inf  #############

mapping &lt;- ara_unconstrained_linf(Z, V)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_5a_Auto-mpg_ARA_unconstrained_linf.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_5a_Auto-mpg_ARA_unconstrained_linf.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 2.60102201410351
</code></pre>
<pre><code class="language-r">########################  Subfigure (b) - ARA Unconstrained l-inf with weights

mapping &lt;- ara_unconstrained_linf(Z, V, weights = w)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_5b_Auto-mpg_ARA_unconstrained_linf_weights.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  weights = w,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_5b_Auto-mpg_ARA_unconstrained_linf_weights.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 2.74022966229282
</code></pre>
<pre><code class="language-r">########################  Subfigure (c) - ARA Exact l-inf  #####################

mapping &lt;- ara_exact_linf(Z, V, variable = 1)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_5c_Auto-mpg_ARA_exact_linf.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_5c_Auto-mpg_ARA_exact_linf.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 3.72333444576546
</code></pre>
<pre><code class="language-r">########################  Subfigure (d) - ARA Ordered l-inf  ###################

mapping &lt;- ara_ordered_linf(Z, V, variable = 1)
P &lt;- mapping$P
colnames(P) &lt;- c(&quot;P1&quot;, &quot;P2&quot;)

# Genearate the ARA plot
filename &lt;- &quot;Figure_5d_Auto-mpg_ARA_ordered_linf.pdf&quot;
pdf(file = filename)
print(draw_radial_axes_plot_2d_standardized(
  Z,
  X,
  V,
  P,
  axis_lines = 1,
  color_variable = 1, # mpg
  show_colorbar = FALSE,
  var_names_scale_factor = c(2, 1.3, 1.2, 1.1),
  var_names_horizontal_factor = 0.12,
  aspect_ratio = 1.5
))
dev.off()
</code></pre>
<pre><code>## png 
##   2
</code></pre>
<pre><code class="language-r">message(&quot;Created subfigure: &quot;, filename, &quot;\n&quot;)
</code></pre>
<pre><code>## Created subfigure: Figure_5d_Auto-mpg_ARA_ordered_linf.pdf
</code></pre>
<pre><code class="language-r">message(&quot;  Objective value: &quot;, mapping$objval, &quot;\n&quot;)
</code></pre>
<pre><code>##   Objective value: 2.63165292624249
</code></pre>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.5.2 (2025-10-31 ucrt)
## Platform: x86_64-w64-mingw32/x64
## Running under: Windows 10 x64 (build 19045)
## 
## Matrix products: default
##   LAPACK version 3.12.1
## 
## locale:
## [1] LC_COLLATE=Spanish_Spain.utf8  LC_CTYPE=Spanish_Spain.utf8    LC_MONETARY=Spanish_Spain.utf8 LC_NUMERIC=C                  
## [5] LC_TIME=Spanish_Spain.utf8    
## 
## time zone: Europe/Madrid
## tzcode source: internal
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ascentTraining_1.0.0 liver_1.24           viridis_0.6.5        viridisLite_0.4.2    RSpectra_0.16-2      geometry_0.5.2      
##  [7] pracma_2.4.6         ggplot2_4.0.1        aramappings_0.1.1    devtools_2.4.6       usethis_3.2.1       
## 
## loaded via a namespace (and not attached):
##  [1] Matrix_1.7-4       gtable_0.3.6       compiler_4.5.2     Rcpp_1.1.0         gridExtra_2.3      scales_1.4.0       clarabel_0.11.1   
##  [8] fastmap_1.2.0      glpkAPI_1.3.4.1    lattice_0.22-7     R6_2.6.1           labeling_0.4.3     knitr_1.50         magic_1.6-1       
## [15] RColorBrewer_1.1-3 rlang_1.1.6        cachem_1.1.0       xfun_0.54          fs_1.6.6           S7_0.2.1           pkgload_1.4.1     
## [22] memoise_2.0.1      cli_3.6.5          withr_3.0.2        magrittr_2.0.4     rstudioapi_0.17.1  remotes_2.5.0      lifecycle_1.0.4   
## [29] vctrs_0.6.5        evaluate_1.0.5     glue_1.8.0         farver_2.1.2       sessioninfo_1.2.3  abind_1.4-8        pkgbuild_1.4.8    
## [36] purrr_1.2.0        tools_4.5.2        ellipsis_0.3.2
</code></pre>
</div>
</body>
</html>
